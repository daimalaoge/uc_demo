{"version":3,"sources":["utils.js"],"names":["layui","define","exports","_","lodash","axios","isObject","msg","oneOf","utils","value","validList","error","console","item","index","localStorage","getItem","flag","key","JSON","parse","data","_typeof","setItem","d","removeItem","find","arr","callback","findKey","tplLoader","that","this","then","res","get","regList","match","ids","forEach","push","filters","length","undefined","matchResult","result","substring","reg","RegExp","regStr","replace","randomCode","catch","errorMsg","request","status","statusText","log","onerror","interval","clearInterval","url","title","setUrlState","Math","random","toString","isFunction","obj","isString"],"mappings":";oOAAAA,MAAMC,QAAQ,SAAU,SAAU,SAASC,GACzC,IAAIC,EAAIH,MAAMI,OACZC,EAAQL,MAAMK,MAmGdC,EAAAA,SArGJN,MAAMC,SAAQM,GACRJ,QAAIH,MAAMI,IAEdI,MAAIC,SAAQC,EAAAC,GACVC,IAAAA,GAAO,EAMH,OALFC,EAAAA,QAAQD,EAAR,SAAAE,EAAAC,GAFQD,IAAAJ,IAIVF,GAAO,KAGCM,GAGLE,cACDC,QAAOC,SAAPC,GAXQ,OAAAC,KAAAC,MAAAL,aAAAC,QAAAE,KAcVH,QAAAA,SAAcG,EAAAG,GACZL,IAAAA,EAAkBE,iBAAT,IAAAG,EAAA,YAAAC,QAAAD,KAAc,gBAAAA,EACrBF,KAAOA,UAAAE,GAAWN,EAFRA,aAAAQ,QAAAL,EAAAM,IAKVC,WAAS,SAAOJ,GAEhBN,aAAaQ,WAAbL,IAEFO,MAAAA,WACEV,aAAaU,UAejBC,KAAM,SAASC,EAAKC,GAClB,OAAOD,EAAIzB,EAAE2B,QAAQF,EAAKC,KAA1BE,UAAOH,SAAME,EAAQF,EAAKC,GAxClB,IAAAG,EAAAC,KA0CVX,EAAA,GAEEjB,EAAI2B,IAAAA,GACJE,KAAIZ,SAAJa,GAEA9B,IAAM+B,KAGEC,GAJRf,EAAAa,EAAAb,MAIIgB,MAAA,eACA,OAAAC,GAAApC,EAAAqC,QAAAD,EAAA,SAAAzB,GAAAuB,EAAAI,KAAA3B,KAEAyB,IAAAA,EAAgBpC,EAAEqC,MAAQD,uBAAsB,OAAAF,GAAAlC,EAAAqC,QAAAE,EAAA,SAAA5B,GAAAuB,EAAAI,KAAA3B,KAChDuB,EAAAM,OAAA,GAEAD,EAAAA,QAAYL,EAAUG,SAAQE,GAA0BL,IAAQI,EAAR3B,EAAAwB,MAAA,WAAxD,QAAAM,IAAAC,GAAA,MAAAA,GAAAA,EAAAF,OAAA,EAAA,CAOM,IAAIG,EAASD,EAAY,GALnBF,EAASG,EAAGC,UAAA,EAAAD,EAAAH,OAAA,GACtBK,EAAA,IAAAC,OAAAC,EAAA,KACEV,EAAQH,EAAVc,QAAmBH,EAASlC,EAAMsC,mBAK9BC,MAAA,SAAUzC,GACVU,IAAAA,EAAOA,EAAK6B,QACbG,EAAA,iBAAAC,EAAAC,OAAA,UAAAD,EAAAE,WACF5C,QARD6C,IAAAJ,GASD,mBAAAK,GAAAA,EAAAL,KAID,IAAAM,EAAIN,YAAW,WACHA,KAAZzC,IACAgD,cAAAD,GA5BJ/B,EAAAP,KA+BA,KAEIuC,YAAAA,SAAcD,EAAdE,GACAjC,QAAAA,aAAAkC,EAAAD,IAGLV,WApFS,WAqFVY,MAAAA,IAAaC,KAAAC,SAAAC,SAASJ,IAAOD,OAAK,IAEjCM,WAvFS,SAAAC,GAwFV,MAAA,mBAAAA,GAEEC,SAAO,SAAML,GA1FL,MAAA,iBAAAI,GA6FR/D,SAAO,SAAA+D,GA7FC,MAAA,iBAAA,IAAAA,EAAA,YAAA9C,QAAA8C","file":"utils.js","sourcesContent":["layui.define(['lodash', 'axios'], function(exports) {\r\n  var _ = layui.lodash,\r\n    axios = layui.axios;\r\n  var utils = {\r\n    error: function(msg) {\r\n      console.error(msg);\r\n    },\r\n    oneOf: function(value, validList) {\r\n      var flag = false;\r\n      _.forEach(validList, function(item, index) {\r\n        if (item === value) {\r\n          flag = true;\r\n        }\r\n      })\r\n      return flag;\r\n    },\r\n    // 本地存储相关 \r\n    localStorage: {\r\n      getItem: function(key) {\r\n        return JSON.parse(localStorage.getItem(key));\r\n      },\r\n      setItem: function(key, data) {\r\n        var d = (typeof data === 'object' || typeof data === 'array') ?\r\n          JSON.stringify(data) : data;\r\n        localStorage.setItem(key, d);\r\n      },\r\n      removeItem: function(key) {\r\n        localStorage.removeItem(key);\r\n      },\r\n      clear: function() {\r\n        localStorage.clear();\r\n      }\r\n    },\r\n    /**\r\n     * 在一个数组里面查询一个对象\r\n     * var r = 1;\r\n     * var arr = [{name:'a',id:1},{name:'b',id:2}]\r\n     * var result = utils.find(arr,function(item){\r\n     *   return r === item.id;\r\n     * });\r\n     *  // result : {name:'a',id:1}\r\n     */\r\n    find: function(arr, callback) {\r\n      return arr[_.findKey(arr, callback)];\r\n    },\r\n    // 读取模板\r\n    tplLoader: function(url, callback, onerror) {\r\n      var that = this;\r\n      var data = '';\r\n      // TODO 跨域未实现\r\n      axios.get(url)\r\n        .then(function(res) {\r\n          data = res.data;\r\n          var regList = [];\r\n          // 重置id 防止冲突\r\n          var ids = data.match(/id=\\\"\\w*\\\"/g);\r\n          ids !== null && _.forEach(ids, function(item) { regList.push(item); });\r\n          // 重置lay-filter 防止冲突\r\n          var filters = data.match(/lay-filter=\\\"\\w*\\\"/g);\r\n          filters !== null && _.forEach(filters, function(item) { regList.push(item); });\r\n\r\n          if (regList.length > 0) {\r\n            // 循环替换\r\n            _.forEach(regList, function(item) {\r\n              var matchResult = item.match(/\\\"\\w*\\\"/);\r\n              if (matchResult !== undefined && matchResult != null && matchResult.length > 0) {\r\n                var result = matchResult[0];\r\n                var regStr = result.substring(1, result.length - 1);\r\n                var reg = new RegExp(regStr, 'g');\r\n                data = data.replace(reg, that.randomCode());\r\n              }\r\n            });\r\n          }\r\n        })\r\n        .catch(function(error) {\r\n          var request = error.request;\r\n          var errorMsg = '读取模板出现异常，异常代码：' + request.status + '、 异常信息：' + request.statusText;\r\n          console.log(errorMsg);\r\n          typeof onerror === 'function' && onerror(errorMsg);\r\n        });\r\n\r\n      var interval = setInterval(function() {\r\n        if (data !== '') {\r\n          clearInterval(interval);\r\n          callback(data);\r\n        }\r\n      }, 50);\r\n    },\r\n    setUrlState: function(title, url) {\r\n      history.pushState({}, title, url);\r\n    },\r\n    // 获取随机字符\r\n    randomCode: function() {\r\n      return 'r' + Math.random().toString(36).substr(2);\r\n    },\r\n    isFunction: function(obj) {\r\n      return typeof obj === 'function';\r\n    },\r\n    isString: function(obj) {\r\n      return typeof obj === 'string';\r\n    },\r\n    isObject: function(obj) {\r\n      return typeof obj === 'object';\r\n    }\r\n  };\r\n  //输出utils接口\r\n  exports('utils', utils);\r\n});"]}